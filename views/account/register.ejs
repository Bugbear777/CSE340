<main class="account-main">
  <section class="account-card">
    <h1><%= title %></h1>

    <!-- Flash Message Display -->
    <% if (errors) { %>
      <ul class="notice">
    <% errors.array().forEach(error => { %>
      <li><%= error.msg %></li>
    <%  }) %>
    </ul>
    <% } %>

    <form class="account-form" action="/account/register" method="post">
      <!-- First Name -->
      <div class="form-group">
        <label for="account_firstname">First Name <span class="req">*</span></label>
        <input
          type="text"
          id="account_firstname"
          name="account_firstname"
          required
          value="<%= typeof account_firstname !== 'undefined' ? account_firstname : '' %>"
          placeholder="first name"
          autocomplete="given-name"
        />
      </div>

      <!-- Last Name -->
      <div class="form-group">
        <label for="account_lastname">Last Name <span class="req">*</span></label>
        <input
          type="text"
          id="account_lastname"
          name="account_lastname"
          required
          value="<%= typeof account_lastname !== 'undefined' ? account_lastname : '' %>"
          placeholder="last name"
          autocomplete="family-name"
        />
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="account_email">Email Address <span class="req">*</span></label>
        <input
          type="email"
          id="account_email"
          name="account_email"
          required
          value="<%= typeof account_email !== 'undefined' ? account_email : '' %>"
          placeholder="you@example.com"
          autocomplete="email"
        />
      </div>

      <!-- Password -->
      <div class="form-group">
        <label for="account_password">Password <span class="req">*</span></label>

        <div class="password-row">
          <input
            type="password"
            id="account_password"
            name="account_password"
            required
            pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{12,}$"
            value="<%= typeof account_password !== 'undefined' ? account_password : '' %>"
            placeholder="Create a strong password"
            autocomplete="new-password"
            aria-describedby="password-help"
          />
          <!-- Optional toggle -->
          <button
            type="button"
            class="btn btn--ghost"
            id="togglePassword"
            aria-label="Show password"
          >
            Show
          </button>
        </div>
        <div class="password-hint">
            Passwords must be at least 12 characters and contain at least 1 number,
            1 capital letter and 1 special character.
        </div>

        <ul class="password-rules" id="password-help">
          <li>Minimum 12 characters</li>
          <li>At least 1 capital letter</li>
          <li>At least 1 number</li>
          <li>At least 1 special character</li>
        </ul>
      </div>

      <p class="form-note">
        <span class="req">*</span> All fields are required.
      </p>

      <button type="submit" class="btn btn--primary">Create Account</button>
    </form>

    <p class="account-help">
      Already have an account?
      <a href="/account/login">Log in</a>
    </p>
  </section>
</main>

<script>
  // Optional: toggle password visibility
  (function () {
    const btn = document.getElementById("togglePassword");
    const input = document.getElementById("account_password");
    if (!btn || !input) return;

    btn.addEventListener("click", function () {
      const isPassword = input.getAttribute("type") === "password";
      input.setAttribute("type", isPassword ? "text" : "password");
      btn.textContent = isPassword ? "Hide" : "Show";
      btn.setAttribute("aria-label", isPassword ? "Hide password" : "Show password");
    });
  })();
</script>
